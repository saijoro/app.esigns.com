import{i as O,d as l,a as T,e as b,b as F,c as E,u as $,R as C,r as S,A as H,j as N}from"./client-BtSaofqp.js";function R(e){return e instanceof Headers?new Headers(e):Array.isArray(e)?new Headers(e):typeof e=="object"?new Headers(e):new Headers}function A(...e){return e.reduce((t,n)=>{const r=R(n);for(const[a,o]of r.entries())t.set(a,o);return t},new Headers)}function h(e,t){const n=t||e||{};return typeof n.method>"u"&&(n.method="GET"),{options:n,middleware:r=>h(void 0,Object.assign(n,{middleware:r})),validator:r=>h(void 0,Object.assign(n,{validator:r})),handler:(...r)=>{const[a,o]=r;Object.assign(n,{...a,extractedFn:a,serverFn:o}),O(a.url);const s=[...n.middleware||[],J(n)];return Object.assign(async i=>v(s,"client",{...a,method:n.method,data:i?.data,headers:i?.headers,context:Object.assign({},a)}).then(d=>d.result),{...a,__executeServer:i=>{const d=i instanceof FormData?I(i):i;return v(s,"server",{...a,...d}).then(c=>({result:c.result,context:c.sendContext}))}})}}}function I(e){const t=e.get("__TSR_CONTEXT");if(e.delete("__TSR_CONTEXT"),typeof t!="string")return{context:{},data:e};try{return{context:l.parse(t),data:e}}catch{return{data:e}}}function M(e){const t=[],n=r=>{r.forEach(a=>{a.options.middleware&&n(a.options.middleware),t.push(a)})};return n(e),t}const y=(e,t,n)=>e({data:t.data,context:t.context,sendContext:t.sendContext,method:t.method,next:r=>{const a={...t.context,...r?.context},o={...t.sendContext,...r?.sendContext??{}},s=A(t.headers,r?.headers);return n({method:t.method,data:t.data,context:a,sendContext:o,headers:s,result:r?.result??t.result})}});function q(e,t){if(e==null)return{};if("~standard"in e){const n=e["~standard"].validate(t);if("value"in n)return n.value;throw n instanceof Promise?new Error("Async validation not supported"):new Error(JSON.stringify(n.issues,void 0,2))}if("parse"in e)return e.parse(t);if(typeof e=="function")return e(t);throw new Error("Invalid validator type!")}async function v(e,t,n){const r=M(e),a=async o=>{const s=r.shift();if(!s)return o;s.options.validator&&(t!=="client"||s.options.validateClient)&&(o.data=await q(s.options.validator,o.data));const i=t==="client"?s.options.client:s.options.server;return i?y(i,o,async d=>{if(t==="client"&&s.options.clientAfter){const c=await a(d);return y(s.options.clientAfter,c,p=>p)}return a(d)}):a(o)};return a({...n,headers:n.headers||{},sendContext:n.sendContext||{},context:n.context||{}})}function J(e){return{_types:void 0,options:{validator:e.validator,validateClient:e.validateClient,client:async({next:t,sendContext:n,...r})=>{var a;const o=await((a=e.extractedFn)==null?void 0:a.call(e,{...r,context:n}));return t(o)},server:async({next:t,...n})=>{var r;const a=await((r=e.serverFn)==null?void 0:r.call(e,n));return t({result:a})}}}}async function P(e,t,n){var r;const a=t[0];if(T(a)&&a.method){const c=a,p=c.data instanceof FormData?"formData":"payload",j=new Headers({...p==="payload"?{"content-type":"application/json",accept:"application/json"}:{},...c.headers instanceof Headers?Object.fromEntries(c.headers.entries()):c.headers||{}});if(c.method==="GET"){const u=b({payload:l.stringify({data:c.data,context:c.context})});u&&(e+=`&${u}`)}const _=new Request(e,{method:c.method,headers:j,...k(c)}),m=await n(_),w=await x(m);if((r=w.headers.get("content-type"))!=null&&r.includes("application/json")){const u=await w.text(),f=u?l.parse(u):void 0;if(F(f)||E(f))throw f;return f}return w}const o=new Request(e,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(t)}),s=await x(await n(o)),i=s.headers.get("content-type"),d=await s.text();return i&&i.includes("application/json")?d?JSON.parse(d):void 0:d}function k(e){return e.method==="POST"?e.data instanceof FormData?(e.data.set("__TSR_CONTEXT",l.stringify(e.context)),{body:e.data}):{body:l.stringify({data:e.data??null,context:e.context})}:{}}async function x(e){if(!e.ok){const t=e.headers.get("content-type"),n=t&&t.includes("application/json"),r=await(async()=>n?await e.json():await e.text())(),a=`Request failed with status ${e.status}`;throw n?new Error(JSON.stringify({message:a,body:r})):new Error([a,`${JSON.stringify(r,null,2)}`].join(`

`))}return e}function G(e,t,n){return`${e}/_server/?_serverFnId=${encodeURI(t)}&_serverFnName=${encodeURI(n)}`}function g(e,t,n){const r=G(window.location.origin,t,n);return Object.assign((...o)=>P(r,o,fetch),{url:r,filename:t,functionId:n})}const U=h({method:"GET"}).handler(g(B,"c_1pabs3o","$$function0")),X=h().handler(g(D,"c_1pabs3o","$$function1")),L=function(){const t=$(),n=C.useLoaderData(),{setCounter:r}=S.useContext(H);return N.jsxs("button",{type:"button",onClick:()=>{r(n),X({data:1}).then(()=>{t.invalidate()})},children:["Add 1 to ",n,"?"]})},V=async()=>await U();function B(e){}function D(e){}export{B as $$function0,D as $$function1,L as component,V as loader};
