import{jsx as e,jsxs as s,Fragment as S}from"react/jsx-runtime";import*as _ from"react";import{useState as w}from"react";import{Controller as p,useForm as T}from"react-hook-form";import*as z from"@radix-ui/react-label";import{cva as D}from"class-variance-authority";import{c as k,I as y}from"./input-BNpTjTIy.js";import*as C from"@radix-ui/react-radio-group";import{DotFilledIcon as G,CheckIcon as U}from"@radix-ui/react-icons";import*as q from"@radix-ui/react-checkbox";import{Eye as $,EyeOff as F,Loader2 as B}from"lucide-react";import{useMutation as L}from"@tanstack/react-query";import{c as Z,s as O}from"./auth-WogFKLky.js";import{useRouter as Y}from"@tanstack/react-router";import"clsx";import"tailwind-merge";import"./fetch--oHJs5c1.js";import"js-cookie";const H=D("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),P=_.forwardRef(({className:l,...t},c)=>e(z.Root,{ref:c,className:k(H(),l),...t}));P.displayName=z.Root.displayName;const V=_.forwardRef(({className:l,...t},c)=>e(C.Root,{className:k("grid gap-2",l),...t,ref:c}));V.displayName=C.Root.displayName;const E=_.forwardRef(({className:l,...t},c)=>e(C.Item,{ref:c,className:k("aspect-square h-4 w-4 rounded-full border border-primary text-primary shadow focus:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50",l),...t,children:e(C.Indicator,{className:"flex items-center justify-center",children:e(G,{className:"h-3.5 w-3.5 fill-primary"})})}));E.displayName=C.Item.displayName;const M=_.forwardRef(({className:l,...t},c)=>e(q.Root,{ref:c,className:k("peer h-4 w-4 shrink-0 rounded-sm border border-primary shadow focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",l),...t,children:e(q.Indicator,{className:k("flex items-center justify-center text-current"),children:e(U,{className:"h-4 w-4"})})}));M.displayName=q.Root.displayName;const J=({control:l,errors:t,getValues:c})=>{const[g,d]=w("individual"),[u,N]=w(""),[h,m]=w(""),[x,j]=w({password:!1,confirmPassword:!1}),[r,o]=w({uppercase:!1,lowercase:!1,number:!1,symbol:!1,passwordMatch:!1}),f={uppercase:/[A-Z]/,lowercase:/[a-z]/,number:/[0-9]/,symbol:/[!@#$%^&*(),.?":{}|<>]/},I=i=>{const a=i.target.value;N(a);const n={uppercase:f.uppercase.test(a),lowercase:f.lowercase.test(a),number:f.number.test(a),symbol:f.symbol.test(a),passwordMatch:a===h};o(n)},A=i=>{const a=i.target.value;m(a),o(n=>({...n,passwordMatch:u===a}))},R=i=>{console.log(i),j(a=>({...a,[i]:!a[i]}))};return s("div",{className:"w-[500px] p-8 flex flex-col justify-start items-center gap-6",children:[s("div",{className:"w-full flex flex-col gap-4",children:[e("div",{className:"text-black text-sm font-normal",children:"Choose Account Type"}),e(p,{name:"plan_type",defaultValue:"individual",control:l,render:({field:i})=>s(V,{...i,className:"w-full flex flex-row",onValueChange:a=>{i.onChange(a),d(a)},children:[s("div",{className:"flex items-center space-x-2",children:[e(E,{value:"individual",id:"individual"}),e(P,{htmlFor:"individual",className:"cursor-pointer",children:"Individual"})]}),s("div",{className:"flex items-center space-x-2",children:[e(E,{value:"business",id:"business"}),e(P,{htmlFor:"business",className:"cursor-pointer",children:"Business"})]})]})})]}),g==="business"&&s("div",{className:"w-full flex flex-col gap-4",children:[s("div",{className:"text-black text-sm font-normal",children:["Company Name",e("span",{className:"text-red-500",children:"*"})]}),e(p,{name:"company",rules:{required:"Company name is required"},control:l,render:({field:i})=>s("div",{className:"w-full",children:[e(y,{...i,type:"text",placeholder:"Enter your company name",className:"h-12 px-4 py-3.5 bg-white border border-black/30"}),t.company&&e("div",{className:"text-red-500 text-sm mt-1 capitalize",children:t?.company?.message})]})})]}),!c("user_exist")&&s(S,{children:[s("div",{className:"w-full flex flex-col gap-4",children:[s("div",{className:"text-black text-sm font-normal",children:["Password",e("span",{className:"text-red-500",children:"*"})]}),e(p,{name:"password",control:l,rules:{required:"Password is required"},render:({field:i})=>s("div",{className:"w-full relative",children:[e(y,{...i,type:x.password?"text":"password",placeholder:"Enter your password",className:"h-12 px-4 py-3.5 bg-white border border-black/30",onChange:a=>{i.onChange(a),I(a)}}),e("button",{type:"button",onClick:()=>R("password"),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-slate-800",children:x.password?e($,{}):e(F,{})}),t.password&&e("div",{className:"text-red-500 text-sm mt-1 capitalize",children:t?.password?.message})]})})]}),s("div",{className:"w-full flex flex-col gap-4",children:[e("div",{className:"text-black text-sm font-normal",children:"Confirm password"}),e(p,{name:"cPassword",control:l,rules:{required:"Confirm password is required"},render:({field:i})=>s("div",{className:"w-full relative",children:[e(y,{...i,type:x?.confirmPassword?"text":"password",placeholder:"Confirm your password",className:"h-12 px-4 py-3.5 bg-white border border-black/30",onChange:a=>{i.onChange(a),A(a)}}),e("button",{type:"button",onClick:()=>R("confirmPassword"),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-slate-800",children:x?.confirmPassword?e($,{}):e(F,{})}),t.cPassword&&e("div",{className:"text-red-500 text-sm mt-1 capitalize",children:t?.cPassword?.message})]})})]}),u?s("div",{className:"w-full flex flex-col gap-4 mt-4",children:[e("div",{className:"text-black text-sm font-normal",children:"Password Requirements:"}),s("ul",{className:"list-disc pl-5",children:[s("li",{className:`flex items-center ${r.uppercase?"text-green-500":"text-red-500"}`,children:[r.uppercase?"✔️":"❌"," At least one uppercase letter (A-Z)"]}),s("li",{className:`flex items-center ${r.lowercase?"text-green-500":"text-red-500"}`,children:[r.lowercase?"✔️":"❌"," At least one lowercase letter (a-z)"]}),s("li",{className:`flex items-center ${r.number?"text-green-500":"text-red-500"}`,children:[r.number?"✔️":"❌"," At least one number (0-9)"]}),s("li",{className:`flex items-center ${r.symbol?"text-green-500":"text-red-500"}`,children:[r.symbol?"✔️":"❌"," At least one symbol (!@#$%^&*)"]}),s("li",{className:`flex items-center ${r.passwordMatch?"text-green-500":"text-red-500"}`,children:[r.passwordMatch?"✔️":"❌"," Passwords match"]})]})]}):""]}),e("div",{className:"flex items-center space-x-2 mt-4",children:e(p,{name:"terms_and_conditions",control:l,render:({field:i})=>s(S,{children:[e(M,{...i,id:"terms",checked:i.value,onCheckedChange:a=>i.onChange(a),className:"w-4 h-4 border border-black/30"}),e(P,{htmlFor:"terms",className:"text-sm cursor-pointer font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:"I agree to eSigns Terms of Service and Privacy Policy"})]})})}),e("div",{className:"w-full py-4 bg-[#0d0d0d] rounded-xl flex justify-center items-center mt-6",children:e("button",{type:"submit",className:"text-white text-lg font-medium w-full",children:"Submit"})})]})},K=({loading:l,label:t})=>l?e("div",{className:"absolute inset-0 z-50 flex items-center justify-center bg-white/80",children:s("div",{className:"flex flex-col items-center gap-8 lg justify-center",children:[e(B,{className:"mr-5 h-7 w-7 animate-spin"}),e("span",{children:t})]})}):null,Q=({control:l,errors:t,step:c,handleNext:g,setValue:d,getValues:u})=>{const[N,h]=w(!1),{mutate:m,isError:x,error:j}=L({mutationFn:async r=>{try{h(!0);const o=await Z(r);if(o?.status===200||o?.status===201){const{message:f}=o?.data;d("first_name",f?.first_name||""),d("last_name",f?.last_name||""),d("phone",f?.phone||""),d("user_exist",!0)}else d("user_exist",!1),d("first_name",""),d("last_name",""),d("phone","")}catch(o){console.error(o)}finally{h(!1)}}});return s("div",{className:"w-[500px] flex flex-col justify-start items-start gap-8",children:[s("div",{className:"w-full flex flex-col justify-start items-start gap-8",children:[s("div",{className:"flex flex-col w-full gap-2.5",children:[s("label",{className:"text-black text-sm font-normal",children:["Email",e("span",{className:"text-red-500",children:"*"})]}),e(p,{name:"email",control:l,rules:{required:"Email is required",pattern:/^\S+@\S+\.\S+$/},render:({field:r})=>s("div",{className:"w-full",children:[e(y,{...r,onBlur:o=>m(o.target.value),type:"email",placeholder:"Enter your email",className:"h-12 px-4 py-3.5 bg-white rounded-lg border border-black/30"}),t.email&&e("div",{className:"text-red-500 text-sm mt-1 capitalize",children:t?.email?.message})]})})]}),s("div",{className:"flex w-full justify-between gap-8",children:[s("div",{className:"flex flex-col w-full gap-2.5",children:[s("label",{className:"text-black text-sm font-normal",children:["First Name",e("span",{className:"text-red-500",children:"*"})]}),e(p,{name:"first_name",control:l,disabled:u("user_exist"),rules:{required:"First Name is required"},render:({field:r})=>s("div",{className:"w-full",children:[e(y,{...r,type:"text",placeholder:"Enter your first name",className:"h-12 px-4 py-3.5 bg-white rounded-lg border border-black/30"}),t.first_name&&e("div",{className:"text-red-500 text-sm mt-1 capitalize",children:t?.first_name?.message})]})})]}),s("div",{className:"flex flex-col w-full gap-2.5",children:[s("label",{className:"text-black text-sm font-normal",children:["Last Name",e("span",{className:"text-red-500",children:"*"})]}),e(p,{name:"last_name",control:l,disabled:u("user_exist"),rules:{required:"Last Name is required"},render:({field:r})=>s("div",{className:"w-full",children:[e(y,{...r,type:"text",placeholder:"Enter your last name",className:"h-12 px-4 py-3.5 bg-white rounded-lg border border-black/30"}),t.last_name&&e("div",{className:"text-red-500 text-sm mt-1 capitalize",children:t?.last_name?.message})]})})]})]}),s("div",{className:"flex flex-col w-full gap-2.5",children:[s("label",{className:"text-black text-sm font-normal",children:["Phone Number",e("span",{className:"text-red-500",children:"*"})]}),e(p,{name:"phone",control:l,rules:{required:"Phone Number is required"},disabled:u("user_exist"),render:({field:r})=>s("div",{className:"w-full",children:[e(y,{...r,type:"text",placeholder:"Enter your phone number",className:"h-12 px-4 py-3.5 bg-white rounded-lg border border-black/30"}),t.phone&&e("div",{className:"text-red-500 text-sm mt-1 capitalize",children:t?.phone?.message})]})})]})]}),c===1&&e("div",{className:"w-full py-4 bg-[#0d0d0d] rounded-xl flex justify-center items-center",children:e("button",{onClick:g,className:"text-white text-lg font-medium w-full",children:"Next"})}),e(K,{loading:N,label:"Please wait, while we are validating your email address."})]})},W=()=>{const l=Y(),{control:t,handleSubmit:c,setError:g,setValue:d,formState:{errors:u},getValues:N,trigger:h}=T({}),[m,x]=w(1),[j,r]=w(!1),o=async a=>{await h()&&x(a)},f=async()=>{await h()&&m<2&&x(m+1)},{mutate:I,isError:A,error:R}=L({mutationFn:async a=>{try{r(!0);const n=await O(a);if(n?.status===200||n?.status===201)l.navigate({to:"/verify",search:{email:N("email"),company_id:n?.data?._id}});else if(n?.status===422){const b=n?.data?.errors?.details;b&&b.forEach(v=>{(v.type==="any.empty"||v.type==="any.required")&&g(v.key,{type:v.type,message:v.message})})}else if(n?.status==404){const b=n?.data?.message;b&&g("email",{type:"manual",message:b})}else if(n?.status==403){const b=n?.data?.message;b&&g("password",{type:"manual",message:b})}else throw n}catch(n){console.error(n)}finally{r(!1)}}});return e("div",{className:"w-full flex justify-center items-center h-full border",children:s("div",{className:"px-6 py-3 top-10 absolute bg-white rounded-2xl shadow flex-col justify-start items-center gap-2 inline-flex border ",children:[s("div",{className:"top-2 justify-center items-center gap-2 inline-flex",children:[e("div",{onClick:()=>o(1),className:`px-4 py-1 rounded-full flex justify-center items-center cursor-pointer ${m===1?"bg-black":"bg-[#f6f6f6]"}`,children:e("div",{className:`text-center ${m===1?"text-[#ffc900]":"text-[#0d0d0d]"} text-lg font-normal`,children:"1"})}),e("div",{className:"w-52 h-[0px] border border-[#333333]"}),e("div",{onClick:()=>o(2),className:`px-4 py-2 rounded-full flex justify-center items-center cursor-pointer ${m===2?"bg-black":"bg-[#f6f6f6]"}`,children:e("div",{className:`text-center ${m===2?"text-[#ffc900]":"text-[#0d0d0d]"} text-lg font-normal`,children:"2"})})]}),s("div",{className:"w-full flex flex-col justify-start items-center gap-4",children:[e("div",{className:"text-center text-black text-2xl font-normal leading-loose",children:"Personal Information"}),e("div",{className:"text-center text-[#333333] text-lg font-light leading-normal",children:"Tell Us About Yourself"})]}),e("div",{children:e("form",{onSubmit:c(async a=>{await h()&&I(a)}),className:"self-stretch flex-col justify-start items-center gap-6 flex",children:m===1?e(Q,{control:t,errors:u,step:m,handleNext:f,setValue:d,getValues:N}):e(J,{control:t,errors:u,getValues:N})})}),s("div",{className:"flex justify-center items-center gap-2",children:[e("div",{className:"text-center text-[#0d0d0d] text-base font-light",children:"Already have an Account?"}),e("div",{className:"text-center text-[#2f80ed] text-base font-normal cursor-pointer",onClick:()=>l.navigate({to:"/signin"}),children:"Log In"})]})]})})},ue=function(){return e(W,{})};export{ue as component};
