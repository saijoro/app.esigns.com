import{jsx as e,jsxs as a,Fragment as A}from"react/jsx-runtime";import*as R from"react";import{useState as w}from"react";import{Controller as p,useForm as L}from"react-hook-form";import*as E from"@radix-ui/react-label";import{cva as M}from"class-variance-authority";import{c as C,I as y}from"./input-BNpTjTIy.js";import*as P from"@radix-ui/react-radio-group";import{DotFilledIcon as T,CheckIcon as V}from"@radix-ui/react-icons";import*as q from"@radix-ui/react-checkbox";import{useMutation as $}from"@tanstack/react-query";import{Loader2 as D}from"lucide-react";import{c as G,s as U}from"./auth-B0wetoCf.js";import{useRouter as B}from"@tanstack/react-router";import"clsx";import"tailwind-merge";import"./fetch-DqQ3Y-nf.js";import"js-cookie";const Z=M("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),I=R.forwardRef(({className:t,...s},d)=>e(E.Root,{ref:d,className:C(Z(),t),...s}));I.displayName=E.Root.displayName;const F=R.forwardRef(({className:t,...s},d)=>e(P.Root,{className:C("grid gap-2",t),...s,ref:d}));F.displayName=P.Root.displayName;const S=R.forwardRef(({className:t,...s},d)=>e(P.Item,{ref:d,className:C("aspect-square h-4 w-4 rounded-full border border-primary text-primary shadow focus:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50",t),...s,children:e(P.Indicator,{className:"flex items-center justify-center",children:e(T,{className:"h-3.5 w-3.5 fill-primary"})})}));S.displayName=P.Item.displayName;const z=R.forwardRef(({className:t,...s},d)=>e(q.Root,{ref:d,className:C("peer h-4 w-4 shrink-0 rounded-sm border border-primary shadow focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",t),...s,children:e(q.Indicator,{className:C("flex items-center justify-center text-current"),children:e(V,{className:"h-4 w-4"})})}));z.displayName=q.Root.displayName;const Y=({control:t,errors:s,getValues:d})=>{const[b,o]=w("individual"),[f,N]=w(""),[h,m]=w(""),[n,_]=w({uppercase:!1,lowercase:!1,number:!1,symbol:!1,passwordMatch:!1}),i={uppercase:/[A-Z]/,lowercase:/[a-z]/,number:/[0-9]/,symbol:/[!@#$%^&*(),.?":{}|<>]/},u=r=>{const l=r.target.value;N(l);const j={uppercase:i.uppercase.test(l),lowercase:i.lowercase.test(l),number:i.number.test(l),symbol:i.symbol.test(l),passwordMatch:l===h};_(j)},g=r=>{const l=r.target.value;m(l),_(j=>({...j,passwordMatch:f===l}))};return a("div",{className:"w-[500px] p-8 flex flex-col justify-start items-center gap-6",children:[a("div",{className:"w-full flex flex-col gap-4",children:[e("div",{className:"text-black text-sm font-normal",children:"Choose Account Type"}),e(p,{name:"plan_type",defaultValue:"individual",control:t,render:({field:r})=>a(F,{...r,className:"w-full flex flex-row",onValueChange:l=>{r.onChange(l),o(l)},children:[a("div",{className:"flex items-center space-x-2",children:[e(S,{value:"individual",id:"individual"}),e(I,{htmlFor:"individual",className:"cursor-pointer",children:"Individual"})]}),a("div",{className:"flex items-center space-x-2",children:[e(S,{value:"business",id:"business"}),e(I,{htmlFor:"business",className:"cursor-pointer",children:"Business"})]})]})})]}),b==="business"&&a("div",{className:"w-full flex flex-col gap-4",children:[a("div",{className:"text-black text-sm font-normal",children:["Company Name",e("span",{className:"text-red-500",children:"*"})]}),e(p,{name:"company",rules:{required:"Company name is required"},control:t,render:({field:r})=>a("div",{className:"w-full",children:[e(y,{...r,type:"text",placeholder:"Enter your company name",className:"h-12 px-4 py-3.5 bg-white border border-black/30"}),s.company&&e("div",{className:"text-red-500 text-sm mt-1 capitalize",children:s?.company?.message})]})})]}),!d("user_exist")&&a(A,{children:[a("div",{className:"w-full flex flex-col gap-4",children:[a("div",{className:"text-black text-sm font-normal",children:["Password",e("span",{className:"text-red-500",children:"*"})]}),e(p,{name:"password",control:t,rules:{required:"Password is required"},render:({field:r})=>a("div",{className:"w-full",children:[e(y,{...r,type:"password",placeholder:"Enter your password",className:"h-12 px-4 py-3.5 bg-white border border-black/30",onChange:l=>{r.onChange(l),u(l)}}),s.password&&e("div",{className:"text-red-500 text-sm mt-1 capitalize",children:s?.password?.message})]})})]}),a("div",{className:"w-full flex flex-col gap-4",children:[e("div",{className:"text-black text-sm font-normal",children:"Confirm password"}),e(p,{name:"cPassword",control:t,rules:{required:"Confirm password is required"},render:({field:r})=>a("div",{className:"w-full",children:[e(y,{...r,type:"password",placeholder:"Confirm your password",className:"h-12 px-4 py-3.5 bg-white border border-black/30",onChange:l=>{r.onChange(l),g(l)}}),s.cPassword&&e("div",{className:"text-red-500 text-sm mt-1 capitalize",children:s?.cPassword?.message})]})})]}),f?a("div",{className:"w-full flex flex-col gap-4 mt-4",children:[e("div",{className:"text-black text-sm font-normal",children:"Password Requirements:"}),a("ul",{className:"list-disc pl-5",children:[a("li",{className:`flex items-center ${n.uppercase?"text-green-500":"text-red-500"}`,children:[n.uppercase?"✔️":"❌"," At least one uppercase letter (A-Z)"]}),a("li",{className:`flex items-center ${n.lowercase?"text-green-500":"text-red-500"}`,children:[n.lowercase?"✔️":"❌"," At least one lowercase letter (a-z)"]}),a("li",{className:`flex items-center ${n.number?"text-green-500":"text-red-500"}`,children:[n.number?"✔️":"❌"," At least one number (0-9)"]}),a("li",{className:`flex items-center ${n.symbol?"text-green-500":"text-red-500"}`,children:[n.symbol?"✔️":"❌"," At least one symbol (!@#$%^&*)"]}),a("li",{className:`flex items-center ${n.passwordMatch?"text-green-500":"text-red-500"}`,children:[n.passwordMatch?"✔️":"❌"," Passwords match"]})]})]}):""]}),e("div",{className:"flex items-center space-x-2 mt-4",children:e(p,{name:"terms_and_conditions",control:t,render:({field:r})=>a(A,{children:[e(z,{...r,id:"terms",checked:r.value,onCheckedChange:l=>r.onChange(l),className:"w-4 h-4 border border-black/30"}),e(I,{htmlFor:"terms",className:"text-sm cursor-pointer font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:"I agree to eSigns Terms of Service and Privacy Policy"})]})})}),e("div",{className:"w-full py-4 bg-[#0d0d0d] rounded-xl flex justify-center items-center mt-6",children:e("button",{type:"submit",className:"text-white text-lg font-medium w-full",children:"Submit"})})]})},H=({loading:t,label:s})=>t?e("div",{className:"absolute inset-0 z-50 flex items-center justify-center bg-white/80",children:a("div",{className:"flex flex-col items-center gap-8 lg justify-center",children:[e(D,{className:"mr-5 h-7 w-7 animate-spin"}),e("span",{children:s})]})}):null,J=({control:t,errors:s,step:d,handleNext:b,setValue:o,getValues:f})=>{const[N,h]=w(!1),{mutate:m,isError:n,error:_}=$({mutationFn:async i=>{try{h(!0);const u=await G(i);if(u?.status===200||u?.status===201){const{message:g}=u?.data;o("first_name",g?.first_name||""),o("last_name",g?.last_name||""),o("phone",g?.phone||""),o("user_exist",!0)}else o("user_exist",!1),o("first_name",""),o("last_name",""),o("phone","")}catch(u){console.error(u)}finally{h(!1)}}});return a("div",{className:"w-[500px] flex flex-col justify-start items-start gap-8",children:[a("div",{className:"w-full flex flex-col justify-start items-start gap-8",children:[a("div",{className:"flex flex-col w-full gap-2.5",children:[a("label",{className:"text-black text-sm font-normal",children:["Email",e("span",{className:"text-red-500",children:"*"})]}),e(p,{name:"email",control:t,rules:{required:"Email is required",pattern:/^\S+@\S+\.\S+$/},render:({field:i})=>a("div",{className:"w-full",children:[e(y,{...i,onBlur:u=>m(u.target.value),type:"email",placeholder:"Enter your email",className:"h-12 px-4 py-3.5 bg-white rounded-lg border border-black/30"}),s.email&&e("div",{className:"text-red-500 text-sm mt-1 capitalize",children:s?.email?.message})]})})]}),a("div",{className:"flex w-full justify-between gap-8",children:[a("div",{className:"flex flex-col w-full gap-2.5",children:[a("label",{className:"text-black text-sm font-normal",children:["First Name",e("span",{className:"text-red-500",children:"*"})]}),e(p,{name:"first_name",control:t,disabled:f("user_exist"),rules:{required:"First Name is required"},render:({field:i})=>a("div",{className:"w-full",children:[e(y,{...i,type:"text",placeholder:"Enter your first name",className:"h-12 px-4 py-3.5 bg-white rounded-lg border border-black/30"}),s.first_name&&e("div",{className:"text-red-500 text-sm mt-1 capitalize",children:s?.first_name?.message})]})})]}),a("div",{className:"flex flex-col w-full gap-2.5",children:[a("label",{className:"text-black text-sm font-normal",children:["Last Name",e("span",{className:"text-red-500",children:"*"})]}),e(p,{name:"last_name",control:t,disabled:f("user_exist"),rules:{required:"Last Name is required"},render:({field:i})=>a("div",{className:"w-full",children:[e(y,{...i,type:"text",placeholder:"Enter your last name",className:"h-12 px-4 py-3.5 bg-white rounded-lg border border-black/30"}),s.last_name&&e("div",{className:"text-red-500 text-sm mt-1 capitalize",children:s?.last_name?.message})]})})]})]}),a("div",{className:"flex flex-col w-full gap-2.5",children:[a("label",{className:"text-black text-sm font-normal",children:["Phone Number",e("span",{className:"text-red-500",children:"*"})]}),e(p,{name:"phone",control:t,rules:{required:"Phone Number is required"},disabled:f("user_exist"),render:({field:i})=>a("div",{className:"w-full",children:[e(y,{...i,type:"text",placeholder:"Enter your phone number",className:"h-12 px-4 py-3.5 bg-white rounded-lg border border-black/30"}),s.phone&&e("div",{className:"text-red-500 text-sm mt-1 capitalize",children:s?.phone?.message})]})})]})]}),d===1&&e("div",{className:"w-full py-4 bg-[#0d0d0d] rounded-xl flex justify-center items-center",children:e("button",{onClick:b,className:"text-white text-lg font-medium w-full",children:"Next"})}),e(H,{loading:N,label:"Please wait, while we are validating your email address."})]})},K=()=>{const t=B(),{control:s,handleSubmit:d,setError:b,setValue:o,formState:{errors:f},getValues:N,trigger:h}=L({}),[m,n]=w(1),[_,i]=w(!1),u=async v=>{await h()&&n(v)},g=async()=>{await h()&&m<2&&n(m+1)},{mutate:r,isError:l,error:j}=$({mutationFn:async v=>{try{i(!0);const c=await U(v);if(c?.status===200||c?.status===201)t.navigate({to:"/verify",search:{email:N("email"),company_id:c?.data?._id}});else if(c?.status===422){const x=c?.data?.errors?.details;x&&x.forEach(k=>{(k.type==="any.empty"||k.type==="any.required")&&b(k.key,{type:k.type,message:k.message})})}else if(c?.status==404){const x=c?.data?.message;x&&b("email",{type:"manual",message:x})}else if(c?.status==403){const x=c?.data?.message;x&&b("password",{type:"manual",message:x})}else throw c}catch(c){console.error(c)}finally{i(!1)}}});return e("div",{className:"w-full flex justify-center items-center h-full border",children:a("div",{className:"px-6 py-3 top-10 absolute bg-white rounded-2xl shadow flex-col justify-start items-center gap-2 inline-flex border ",children:[a("div",{className:"top-2 justify-center items-center gap-2 inline-flex",children:[e("div",{onClick:()=>u(1),className:`px-4 py-1 rounded-full flex justify-center items-center cursor-pointer ${m===1?"bg-black":"bg-[#f6f6f6]"}`,children:e("div",{className:`text-center ${m===1?"text-[#ffc900]":"text-[#0d0d0d]"} text-lg font-normal`,children:"1"})}),e("div",{className:"w-52 h-[0px] border border-[#333333]"}),e("div",{onClick:()=>u(2),className:`px-4 py-2 rounded-full flex justify-center items-center cursor-pointer ${m===2?"bg-black":"bg-[#f6f6f6]"}`,children:e("div",{className:`text-center ${m===2?"text-[#ffc900]":"text-[#0d0d0d]"} text-lg font-normal`,children:"2"})})]}),a("div",{className:"w-full flex flex-col justify-start items-center gap-4",children:[e("div",{className:"text-center text-black text-2xl font-normal leading-loose",children:"Personal Information"}),e("div",{className:"text-center text-[#333333] text-lg font-light leading-normal",children:"Tell Us About Yourself"})]}),e("div",{children:e("form",{onSubmit:d(async v=>{await h()&&r(v)}),className:"self-stretch flex-col justify-start items-center gap-6 flex",children:m===1?e(J,{control:s,errors:f,step:m,handleNext:g,setValue:o,getValues:N}):e(Y,{control:s,errors:f,getValues:N})})}),a("div",{className:"flex justify-center items-center gap-2",children:[e("div",{className:"text-center text-[#0d0d0d] text-base font-light",children:"Already have an Account?"}),e("div",{className:"text-center text-[#2f80ed] text-base font-normal cursor-pointer",onClick:()=>t.navigate({to:"/signin"}),children:"Log In"})]})]})})},me=function(){return e(K,{})};export{me as component};
